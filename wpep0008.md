| Key | Value |
| ---: | :--- |
| **Title** | Wazo integration tests framework |
| **Number** | 0008 |
| **Date** | 2023-08-28 |
| **Authors** | Jesse Sopel <jesse.sopel@wazo.io>, Sebastien Duthil <sduthil@wazo.io> |
| **Status** | draft |

## Abstract

Wazo integration tests: Explicit the direction of evolution of integration tests

## Motivation

The integration test framework was implemented in Wazo before the usage of
pytest. Pytest offers a very Pythonic way to organize tests and fixtures, and we
want to use this system more and more, since it offers more flexibility,
readability, performance and reusability.

## State of the art in Wazo Platform

Integration tests are organised around `AssetLaunchingTestCase`, inheriting from
the `unittest` testing framework. This organization forces tests to be organized
around a test class, which may not be as flexible as we want.

## Rejected propositions

* None, this proposition emerged from a refactor proposition that looked promising.

## Proposition

* Migrate all Wazo Platform projects to Pytest (looking at you wazo-confd!)
* Use Pytest fixtures system as much as possible for organizing tests and fixtures.

The `AssetLaunchingTestCase` class [was
refactored](https://github.com/wazo-platform/wazo-test-helpers/pull/89) to be
usable in more Pytest friendly patterns, while keeping retrocompatibility with
the former style of tests.

## Example

An example implementation using more Pytest-oriented patterns can be read in
[wazo-agid](https://github.com/wazo-platform/wazo-agid/pull/127/files).

## Implementations

A more Pytest-oriented style has been used in two repos to date:

* [wazo-agid](https://github.com/wazo-platform/wazo-agid/pull/127/files)
* [wazo-sms](https://github.com/wazo-communication/wazo-sms/pull/9)
